<!--- https://stackoverflow.com/questions/12652769/rendering-html-elements-to-canvas --->

<html>
<head>
    <meta charset="utf-8" />
    <title>Landscape</title>
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <script src="aframe.min.js"></script>
    <!-- Load stuff related to AFrame plugins -->
	<script src="stackblur.min.js"></script>
	<script src="d3.js"></script>
	<script src="aframe-heatmap3d.js"></script>
	<script src="aframe-orbit-controls-component.min.js"></script>
	<script src="surface-lines.js"></script>
	<script src="aframe-camera-transform-controls-component.min.js">
    </script>
     <script src= "https://mozilla.github.io/pdf.js/build/pdf.js">
    </script>
    <style>
    </style>
</head>

<body>    
<script type="text/javascript">    
function renderPDF(url, canvas, options) {
    // SEE: https://mozilla.github.io/pdf.js/examples/
    var options = options || { scale: 1 };
    //
    // The workerSrc property shall be specified.
    //
    pdfjsLib.GlobalWorkerOptions.workerSrc = 'https://mozilla.github.io/pdf.js/build/pdf.worker.js'
    //
    // Asynchronous download PDF
    //
    var loadingTask = pdfjsLib.getDocument(url);
    loadingTask.promise.then(function(pdf) {
        //
        // Fetch the first page
        //
        //    console.log('fetch document: ', url);
        pdf.getPage(1).then(function(page) {
           // console.log('loaded page');
            var scale = 0.6;
            var viewport = page.getViewport({ scale: scale, });
            //
            // Prepare canvas using PDF page dimensions
            //
            // var canvas = document.getElementById('canvas');
            var ctx = canvas.getContext('2d');
            //canvas.height = viewport.height;
            //canvas.width = viewport.width;
           // console.log('canvas:', canvas.width,' x ', canvas.height);
            //
            // Render PDF page into canvas context
            //
            var renderContext = {
                canvasContext: ctx,
                viewport: viewport
            };
            page.render(renderContext);
        });
    });
}   
</script> 
    
<a-scene >
<canvas id='holder' width='400' height='500' hidden='true'> </canvas> 
<script type="text/javascript">
var url =  'http://svalver.github.io/papers/PATH_HORIZON_2004.pdf';
//var url = 'https://patentimages.storage.googleapis.com/c4/23/2a/4bc00364e0e4cd/US4870389.pdf'; 
// https://developer.mozilla.org/en-US/docs/Web/API/HTMLElement/hidden
renderPDF(url, document.getElementById('holder'));
</script>
    <a-assets>
                <img id="fun4" src="fun_4.jpg"/>
    </a-assets>
        
    <a-plane 
                position="0 0.2 0" 
                rotation="0 0 0" 
                width = "0.5" 
                height = "0.5" 
                color = "#7BC8A4" 
                material = "src: #holder"
                side = "double"
     ></a-plane>
        
            <!-- Give camera something to focus on -->
            <a-entity
                id="target"
			    geometry="primitive: box"
                position="0 0 0"
                material="visible:false">
            </a-entity>
        
            <!-- Make the finess landscape -->
		  <a-entity	
			id="middle"
			aframe-heatmap3d="
			src: #fun4;
			srcMobile: #fun4;
			ignoreZeroValues:false; 
			invertElevation:false;
			palette:parula;
			metalness:.2;
			roughness:0;
			stackBlurRadius:1;		
			stretch:true;
			flipPalette:false; 
			renderMode: surface;
			scaleOpacity: false;
			scaleOpacityMethod:log2;
			opacityMin: 0.29; 
			width: 1; height: 1;" scale="1 1 1">
		</a-entity>		
        

		<!-- Handle all of the cameras for different ways of viewing the visualization -->
		<a-entity id="cameraRig">
            <!-- camera -->
			<a-entity
			camera="active:true;"
			id="camera_orbit"
			position="0 1 0"
			look-controls="pointerLockEnabled:false"
			wasd-controls="fly:true"
			orbit-controls="
			autoRotate: false;
			target: #target;
			enableDamping: true;
			dampingFactor: 0.125;
			rotateSpeed:0.15;
			zoomSpeed:0.5;
			maxPolarAngle:1.85;">
			</a-entity>
        
            <a-entity id="lefthand" camera-transform-controls-hand="hand:left" vive-controls="hand: left" oculus-touch-controls="hand: left" windows-motion-controls="hand: left">
            </a-entity>
        
            <a-entity id="righthand" camera-transform-controls-hand="hand:right" vive-controls="hand: right" oculus-touch-controls="hand: right" windows-motion-controls="hand: right">
            </a-entity>
        </a-entity>
    </a-scene>
</body>
</html>